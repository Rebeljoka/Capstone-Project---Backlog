{% extends 'base.html' %} {% block content %}
<div class="container mx-auto px-4 py-8 max-w-4xl">
	<!-- Header Section -->
	<div class="mb-8">
		<div class="flex justify-between items-center">
			<div>
				<h1 class="text-4xl font-bold text-base-content mb-2">Your Wishlists</h1>
				<p class="text-gray-600">Organize your favorite games into custom lists</p>
			</div>
			<a href="{% url 'wishlist_create' %}" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-medium flex items-center gap-2 transition-colors shadow-md hover:shadow-lg">
				<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
				</svg>
				Create New Wishlist
			</a>
		</div>
	</div>

	<!-- Wishlists Grid -->
	{% if wishlists %}
	<div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
		{% for wishlist in wishlists %}
	<div class="rounded-xl shadow-md hover:shadow-lg transition-shadow border border-gray-200 overflow-hidden group bg-[var(--color-card-bg)]">
			<!-- Wishlist Card -->
			<div class="p-6 wishCard bg-transparent">
				<!-- Wishlist Icon & Title -->
				<div class="flex items-start justify-between mb-4">
					<div class="flex items-center gap-3">
						<div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-blue-500 rounded-lg flex items-center justify-center">
							<svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
							</svg>
						</div>
						<div>
							<h3 class="text-lg font-semibold text-gray-100 group-hover:text-blue-600 transition-colors">{{ wishlist.name }}</h3>
							<p class="text-sm text-gray-500">{% if wishlist.items.count %} {{ wishlist.items.count }} game{{ wishlist.items.count|pluralize }} {% else %} Empty wishlist {% endif %}</p>
						</div>
					</div>

					<!-- Options Menu -->
					<div class="relative">
						<button class="opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-gray-100 rounded" onclick="toggleMenu({{ wishlist.id }})">
							<svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
								<path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"></path>
							</svg>
						</button>
						<div id="menu-{{ wishlist.id }}" class="hidden absolute right-0 mt-2 w-48 bg-red-500 rounded-md shadow-lg py-1 z-10 border">
							<form action="{% url 'wishlist_delete' wishlist.id %}" method="post" class="block">
								{% csrf_token %}
								<button type="submit" onclick="return confirm('Are you sure you want to delete this wishlist?');" class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-400 flex items-center gap-2 border border-red-500 hover:border-red-400">
									<span class="nf nf-oct-trash text-white"> Delete Wishlist </span>
								</button>
							</form>
						</div>
					</div>
				</div>

				<!-- Wishlist Preview -->
				{% if wishlist.items.all %}
				<div class="mb-4">
					<div class="flex -space-x-2 mb-2">
						{% for item in wishlist.items.all|slice:":3" %} {% if item.game.image %}
						<img src="{{ item.game.image }}" alt="{{ item.game.title }}" class="w-8 h-8 rounded border-2 border-white object-cover" />
						{% endif %} {% endfor %} {% if wishlist.items.count > 3 %}
						<div class="w-8 h-8 rounded border-2 border-white bg-gray-200 flex items-center justify-center">
							<span class="text-xs text-gray-900">+{{ wishlist.items.count|add:"-3" }}</span>
						</div>
						{% endif %}
					</div>
					<p class="text-xs text-gray-800">Recent: {% for item in wishlist.items.all|slice:":2" %} {{ item.game.title }}{% if not forloop.last %}, {% endif %} {% endfor %}</p>
				</div>
				{% else %}
				<div class="mb-4 p-4 bg-white rounded-lg text-center">
					<svg class="w-8 h-8 text-gray-900 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path>
					</svg>
					<p class="text-sm !text-black">No games yet</p>
				</div>
				{% endif %}

				<!-- Action Button -->
				<a href="{% url 'wishlist_detail' wishlist.id %}" class="block w-full bg-blue-400 hover:bg-blue-600 text-base-content hover:text-blue-600 text-center py-3 rounded-lg font-medium transition-colors border border-blue-400 hover:border-blue-600"> View Wishlist </a>
			</div>
		</div>
		{% endfor %}
	</div>
	{% else %}
	<!-- Empty State -->
	<div class="text-center py-16">
		<div class="mb-6">
			<svg class="w-24 h-24 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
			</svg>
		</div>
		<h3 class="text-xl font-semibold text-base-content mb-2">No wishlists yet</h3>
		<p class="text-gray-500 mb-6 max-w-md mx-auto">Create your first wishlist to start organizing your favorite games. You can have multiple wishlists for different purposes!</p>
		<a href="{% url 'wishlist_create' %}" class="inline-flex items-center gap-2 bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-medium transition-colors shadow-md hover:shadow-lg">
			<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
			</svg>
			Create Your First Wishlist
		</a>
	</div>
	{% endif %}
</div>

<!-- JavaScript for dropdown menus -->
<script>
	function toggleMenu(wishlistId) {
		const menu = document.getElementById("menu-" + wishlistId);
		const allMenus = document.querySelectorAll('[id^="menu-"]');

		// Close all other menus
		allMenus.forEach((m) => {
			if (m.id !== "menu-" + wishlistId) {
				m.classList.add("hidden");
			}
		});

		// Toggle current menu
		menu.classList.toggle("hidden");
	}

	// Close menus when clicking outside
	document.addEventListener("click", function (event) {
		if (!event.target.closest("button")) {
			const allMenus = document.querySelectorAll('[id^="menu-"]');
			allMenus.forEach((m) => m.classList.add("hidden"));
		}
	});
</script>
{% endblock %}
