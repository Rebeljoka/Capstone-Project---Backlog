{% extends 'base.html' %}
{% block content %}
<h1>All Games</h1>
<form method="get">
  <label for="genre">Filter by genre:</label>
  <select name="genre" id="genre" onchange="this.form.submit()">
    <option value="">All</option>
    {% for genre in genres %}
      <option value="{{ genre.genre_id }}" {% if genre.genre_id|stringformat:'s' == selected_genre %}selected{% endif %}>{{ genre.genre }}</option>
    {% endfor %}
  </select>
  <label for="tag">Filter by tag:</label>
  <select name="tag" id="tag" onchange="this.form.submit()">
    <option value="">All</option>
    {% for tag in tags %}
      <option value="{{ tag.tag_id }}" {% if tag.tag_id|stringformat:'s' == selected_tag %}selected{% endif %}>{{ tag.name }}</option>
    {% endfor %}
  </select>
</form>
<section class="game-list">
  {% for game in games %}
    <div class="game-card" style="border:1px solid #ccc; border-radius:8px; padding:1em; margin-bottom:1em; box-shadow:0 2px 6px #eee;">
      <h2><a href="{% url 'game_detail' game.pk %}">{{ game.title }}</a></h2>
      <p><strong>Developer:</strong> {{ game.developer }}</p>
      {% if game.image %}
        <img src="{{ game.image }}" alt="{{ game.title }} cover" style="max-width:150px; display:block; margin-bottom:0.5em;" />
      {% endif %}
      <p>{{ game.short_description }}</p>
      <p><strong>Genres:</strong> {% for genre in game.genres.all %}{{ genre.genre }}{% if not forloop.last %}, {% endif %}{% endfor %}</p>
      <p><strong>Tags:</strong> {% for tag in game.tags.all %}{{ tag.name }}{% if not forloop.last %}, {% endif %}{% endfor %}</p>
    </div>
  {% empty %}
    <div>No games found.</div>
  {% endfor %}
</section>
{% endblock %}